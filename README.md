# 查询宿舍剩余电量

利用[172.27.2.95:8899/query/](http://172.27.2.95:8899/query/)这个地址和南大表格查询并记录宿舍剩余电量

## 设置
- 南大在线表格
- 房间编号

### 表格配置
1. 在[table.nju.edu.cn](https://table.nju.edu.cn)创建一张表格，创建子表`Data`和`Log`
2. 在`Data`中，设置两列：时间（文本类型），电量（数字类型）
3. 在`Log`中，设置三列：时间（文本类型），内容（文本类型），代码（数字类型）
### 添加脚本
1. 点击“脚本”按钮，复制或导入`main.py`中的内容
2. `room_id`可以自行通过[172.27.2.95:8899/query/](http://172.27.2.95:8899/query/)查询

### 自动化规则
1. 可以在“规则->自动化规则”中自行添加定时触发脚本，触发条件为”添加新纪录“
2. 也可以在”第三方集成“中添加企业微信机器人或邮箱来提醒

### 高级统计
可以使用”统计“或”插件->高级统计"来绘制统计图

## 效果

## TODO
- [ ] 显示当前电量（Seatable高级统计功能）
- [ ] 显示每日用电消耗
- [ ] 充值记录问题

## 感谢

我原本想用南大APP的接口来获取剩余电量，但貌似需要统一身份认证，后来搜到[NJU_MonitorElectricityCosts](https://github.com/GeRongcun/NJU_MonitorElectricityCosts)才知道有一个很方便的网站可以用。需要注意网站更新时间是在上午十点左右和晚上十点左右。